set(CMAKE_SYSTEM_NAME Generic)
set(CMAKE_SYSTEM_PROCESSOR x86_64)

set_property(GLOBAL PROPERTY TARGET_SUPPORTS_SHARED_LIBS TRUE)

set(CMAKE_SYSTEM_INCLUDE_PATH)
set(CMAKE_SYSTEM_LIBRARY_PATH)
set(CMAKE_SYSTEM_PROGRAM_PATH)

set(CMAKE_SHARED_LIBRARY_PREFIX "lib")
set(CMAKE_SHARED_LIBRARY_SUFFIX ".so")
set(CMAKE_SHARED_MODULE_PREFIX "lib")
set(CMAKE_SHARED_MODULE_SUFFIX ".so")
set(CMAKE_IMPORT_LIBRARY_PREFIX "lib")
set(CMAKE_IMPORT_LIBRARY_SUFFIX ".a")
set(CMAKE_EXECUTABLE_SUFFIX "e")
set(CMAKE_FIND_LIBRARY_PREFIXES "lib")
set(CMAKE_FIND_LIBRARY_SUFFIXES ".a")

set(CMAKE_SYSTEM_INCLUDE_PATH ${CMAKE_SOURCE_DIR}/include)
set(CMAKE_SYSTEM_LIBRARY_PATH ${CMAKE_SOURCE_DIR}/lib)
set(CMAKE_SYSTEM_PROGRAM_PATH ${CMAKE_SOURCE_DIR}/bin)

set(CMAKE_C_COMPILER clang)
set(CMAKE_C_COMPILER_WORKS ON)

set(CMAKE_C_COMPILE_OPTIONS_PIC "-fPIC")
set(CMAKE_C_COMPILE_OPTIONS_PIE "-fPIE")
set(CMAKE_SHARED_LIBRARY_C_FLAGS "-fPIC")
set(CMAKE_LINKER_TYPE LLD)
set(CMAKE_C_USING_LINKER_LLD ld.lld)
set(CMAKE_C_USING_LINKER_MODE TOOL)
set(CMAKE_ASM_NASM_COMPILER nasm)
set(CMAKE_C_COMPILER_ID Clang)
set(CMAKE_C_SIMULATE_ID Clang)
set(CMAKE_C_COMPILER_LINKER_ID LLD)

set(CMAKE_C_STANDARD 11)
set(CMAKE_C_EXTENSIONS OFF)

set(CMAKE_C_ARCHIVE_CREATE "<CMAKE_AR> qc <TARGET> <LINK_FLAGS> <OBJECTS>")
set(CMAKE_C_ARCHIVE_APPEND "<CMAKE_AR> q <TARGET> <LINK_FLAGS> <OBJECTS>")
set(CMAKE_C_ARCHIVE_FINISH "<CMAKE_RANLIB> <TARGET>")
set(CMAKE_C_CREATE_SHARED_LIBRARY "<CMAKE_LINKER> <LANGUAGE_COMPILE_FLAGS> <CMAKE_SHARED_LIBRARY_C_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_LIBRARY_CREATE_C_FLAGS> --shared --oformat=elf -o <TARGET> ${CMAKE_GNULD_IMAGE_VERSION} <OBJECTS> <LINK_LIBRARIES>")
set(CMAKE_C_CREATE_SHARED_MODULE "<CMAKE_LINKER> <LANGUAGE_COMPILE_FLAGS> <CMAKE_SHARED_MODULE_C_FLAGS> <LINK_FLAGS> <CMAKE_SHARED_MODULE_CREATE_C_FLAGS> --shared --oformat=elf -o <TARGET> ${CMAKE_GNULD_IMAGE_VERSION} <OBJECTS> <LINK_LIBRARIES>")
set(CMAKE_C_LINK_EXECUTABLE "<CMAKE_LINKER> <CMAKE_C_LINK_FLAGS> <LINK_FLAGS> <OBJECTS> --oformat=elf -o <TARGET> ${CMAKE_GNULD_IMAGE_VERSION} <LINK_LIBRARIES>")
set(CMAKE_C_COMPILER_TARGET x86_64-pc-unknown-unknown)

set(CMAKE_ASM_NASM_SOURCE_FILE_EXTENSIONS nasm)
set(CMAKE_ASM_NASM_OBJECT_FORMAT elf64)
set(CMAKE_ASM_NASM_COMPILE_OBJECT "<CMAKE_ASM_NASM_COMPILER> <DEFINES> <INCLUDES> <FLAGS> -f ${CMAKE_ASM_NASM_OBJECT_FORMAT} -o <OBJECT> <SOURCE>")

set(CMAKE_ASM_NASM_FLAGS_DEBUG "${CMAKE_ASM_NASM_FLAGS} -g -Ox -DNDEBUG")
set(CMAKE_ASM_NASM_FLAGS_MINSIZEREL "${CMAKE_ASM_NASM_FLAGS} -Os -DNDEBUG")
set(CMAKE_ASM_NASM_FLAGS_RELEASE "${CMAKE_ASM_NASM_FLAGS} -O3 -DNDEBUG")
set(CMAKE_ASM_NASM_FLAGS_RELWITHDEBINFO "${CMAKE_ASM_NASM_FLAGS} -O2 -g -DNDEBUG")
set(CMAKE_C_FLAGS "-m64 -flto -fPIE -nostdlibinc -ffreestanding -O3")
add_link_options("--pie" "-nostdlib")